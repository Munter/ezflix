#!/usr/bin/env node

var eztvQuery = require('eztv-query');
var spawn = require('child_process').spawn;
var query = [], options = [];
process.argv.slice(2).forEach(function (arg) {
    (arg.indexOf('-') === 0 ? options : query).push(arg);
});

if (options.indexOf('-h') !== -1) {
    return spawn('peerflix', options, { stdio: 'inherit' });
}

eztvQuery(query.join(' '), function (err, episode) {
    if (err) { throw err; }

    spawn('peerflix', [episode.magnet].concat(options), { stdio: 'inherit' });
});
